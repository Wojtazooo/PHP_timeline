<div id="createEventModal" class="modal">
    <div class="modal-content">
        <div id="createEventModalSpinner" class="loader" style="display: none"></div>
        <span class="close">&times;</span>
        <h2>Add new event</h2>
        <form id="createEventForm">
            <label for="eventTitle">Title:</label><br>
            <input type="text" id="eventTitle" name="eventTitle" required><br><br>

            <label for="eventStart">Start Date:</label><br>
            <input type="text" id="eventStart" required><br><br>

            <label for="eventEnd">End Date:</label><br>
            <input type="text" id="eventEnd" name="eventEnd" required><br><br>

            <label for="eventDescription">Description:</label><br>
            <textarea id="eventDescription" name="eventDescription" required></textarea><br><br>

            <label for="eventPicture">Picture URL:</label><br>
            <input type="text" id="eventPicture" name="eventPicture" required><br><br>

            <label for="eventCategoryId">Category ID:</label><br>
            <input type="number" id="eventCategoryId" name="eventCategoryId" required><br><br>

            <button type="submit" class="btn">Save</button>
        </form>
    </div>
</div>


<script>
    const datePickerSettings = {
        dateFormat: "dd-mm-yy",
        changeMonth: true,
        changeYear: true,
        yearRange: "1900:2100"
    };

    $(document).ready(function () {
        $("#eventStart").datepicker(datePickerSettings);
        $("#eventEnd").datepicker(datePickerSettings);
    });

    $('.close').on('click', function () {
        $('#createEventModal').fadeOut();
    });

    $(window).on('click', function (event) {
        if ($(event.target).is('#createEventModal')) {
            $('#createEventModal').fadeOut();
        }
    });

    $('#createEventForm').on('submit', function (e) {
        e.preventDefault();
        $('#createEventModalSpinner').show();

        const title = $('#eventTitle').val();
        const start = $('#eventStart').val();
        const end = $('#eventEnd').val();
        const description = $('#eventDescription').val();
        const picture = $('#eventPicture').val();
        const categoryId = $('#eventCategoryId').val();

        $.ajax({
            url: 'api/events/createEvent.php',
            type: 'POST',
            data: {
                title: title,
                start: start,
                end: end,
                description: description,
                picture: picture,
                categoryId: categoryId
            },
            success: function (response) {
                console.log('Wydarzenie zapisane:', response);
                alert('Wydarzenie zosta≈Ço zapisane: ' + title);
                $('#createEventForm')[0].reset();
                $('#createEventModal').fadeOut();
            },
            error: function (xhr, status, error) {
                alert(status + ': ' + error + ' - ' + xhr.responseText);
            },
            complete: function () {
                $('#createEventModalSpinner').hide();
            }
        });
    });
</script>